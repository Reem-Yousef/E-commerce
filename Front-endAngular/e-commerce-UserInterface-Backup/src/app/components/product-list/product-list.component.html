<div class="product-list-container">
  <div class="list-header">
    <div class="product-header">
      <div class="product-container-header">
        <div class="title">
          <span>Shop</span>
        </div>

        <!-- Search Section -->
        <div class="search-section">
          <div class="search-container">
            <div class="search-input-wrapper">
              <input
                type="text"
                [(ngModel)]="searchQuery"
                (input)="onSearchInput($event)"
                (keyup.enter)="onSearchSubmit()"
                (focus)="showSuggestions = searchSuggestions.length > 0"
                placeholder="Search for products..."
                class="search-input"
                autocomplete="off">

              <button
                *ngIf="searchQuery"
                (click)="clearSearch()"
                class="clear-search-btn"
                type="button">
                Ã—
              </button>

              <button
                (click)="onSearchSubmit()"
                class="search-btn"
                type="button">
                search
              </button>
            </div>

            <!-- Search Suggestions -->
            <div *ngIf="showSuggestions && searchSuggestions.length > 0" class="suggestions-dropdown">
              <div
                *ngFor="let suggestion of searchSuggestions"
                (click)="selectSuggestion(suggestion)"
                class="suggestion-item">
                {{ suggestion }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Filters and Controls Section -->
    <div class="filters-section">
      <div class="results-info">
        <span *ngIf="!loading">
          Showing {{ resultsCount }} of {{ totalResults }} results
          <span *ngIf="searchQuery"> for "{{ searchQuery }}"</span>
        </span>
        <span *ngIf="loading">Loading...</span>
      </div>

      <div class="controls-row">
        <!-- Brand Filter -->
        <div class="brand-filter">
          <select
            [(ngModel)]="selectedBrand"
            (change)="onBrandChange($event)"
            class="brand-dropdown dropdown">
            <option value="">All Brands</option>
            <option *ngFor="let brand of brands" [value]="brand">{{ brand }}</option>
          </select>
        </div>

        <!-- Price Range Filter -->
        <div class="price-filter">
          <div class="price-inputs">
            <input
              type="number"
              [(ngModel)]="minPrice"
              (change)="onPriceRangeChange()"
              [placeholder]="'Min: $ ' + priceRange.min"
              class="price-input"
              min="0">
            <span class="price-separator">-</span>
            <input
              type="number"
              [(ngModel)]="maxPrice"
              (change)="onPriceRangeChange()"
              [placeholder]="'Max: $' + priceRange.max"
              class="price-input"
              min="0">
          </div>
        </div>

        <!-- Stock Filter -->
        <div class="stock-filter">
          <label class="checkbox-label">
            <input
              type="checkbox"
              [(ngModel)]="inStockOnly"
              (change)="onInStockChange()"
              class="checkbox-input">
            <span class="checkbox-text">In Stock Only</span>
          </label>
        </div>

        <!-- Rating Filter -->
        <div class="rating-filter">
          <select
            [(ngModel)]="minRating"
            (change)="onRatingChange()"
            class="rating-dropdown dropdown">
            <option [ngValue]="null">Any Rating</option>
            <option [ngValue]="4">4+ Stars</option>
            <option [ngValue]="3">3+ Stars</option>
            <option [ngValue]="2">2+ Stars</option>
            <option [ngValue]="1">1+ Stars</option>
          </select>
        </div>

        <!-- Sort Controls -->
        <div class="sort-controls">
          <select
            [(ngModel)]="selectedSort"
            (change)="onSortChange(selectedSort)"
            class="sort-dropdown dropdown">
            <option *ngFor="let option of sortOptions" [value]="option.value">
              {{ option.label }}
            </option>
          </select>
        </div>

        <!-- Clear Filters -->
        <button
          (click)="clearFilters()"
          class="clear-filters-btn"
          *ngIf="selectedBrand || minPrice || maxPrice || inStockOnly || minRating">
          Clear Filters
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="loading-spinner"></div>
    <p>Loading products...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-state">
    <p>{{ error }}</p>
    <button (click)="loadProducts()" class="retry-btn">Try Again</button>
  </div>

  <!-- Products Grid -->
  <div *ngIf="!loading && !error" class="products-grid">
    <app-product-card
      *ngFor="let product of filteredProducts; trackBy: trackByProductId"
      [product]="product">
    </app-product-card>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && !error && filteredProducts.length === 0" class="empty-state">
    <p>No products found.</p>
    <button *ngIf="searchQuery || selectedBrand || minPrice || maxPrice || inStockOnly || minRating"
            (click)="clearFilters()"
            class="clear-filters-btn">
      Clear all filters
    </button>
  </div>

  <!-- Pagination -->
  <div *ngIf="!loading && !error && totalPages > 1" class="pagination">
    <button
      (click)="previousPage()"
      [disabled]="currentPage === 1"
      class="pagination-btn">
      Previous
    </button>

    <div class="page-numbers">
      <button
        *ngFor="let page of getPageNumbers()"
        (click)="goToPage(page)"
        [class.active]="page === currentPage"
        class="page-btn">
        {{ page }}
      </button>
    </div>

    <button
      (click)="nextPage()"
      [disabled]="currentPage === totalPages"
      class="pagination-btn">
      Next
    </button>
  </div>
</div>


